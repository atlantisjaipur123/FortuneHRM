generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Company {
  id                     String                   @id @default(cuid())
  code                   String                   @unique @db.VarChar(50)
  name                   String
  serviceName            String?
  status                 CompanyStatus            @default(ACTIVE)
  visibility             CompanyVisibility        @default(PRIVATE)
  startDate              DateTime?                @db.Date
  endDate                DateTime?                @db.Date
  dateOfStartingBusiness DateTime?                @db.Date
  cin                    String?                  @db.VarChar(21)
  pan                    String                   @unique(map: "company_pan_key") @db.VarChar(10)
  tan                    String                   @unique(map: "company_tan_key") @db.VarChar(10)
  gstin                  String?                  @unique(map: "company_gstin_key") @db.VarChar(15)
  flat                   String
  road                   String?
  city                   String
  state                  StateCode
  pin                    String                   @db.VarChar(6)
  stdCode                String?
  phone                  String?
  email                  String?                  @db.VarChar(255)
  website                String?
  pfRegionalOffice       String?
  pensionCoverageDate    DateTime?                @db.Date
  esiLocalOffice         String?
  ptoCircleNo            String?
  pfCoverageDate         DateTime?                @db.Date
  esiNumber              String?
  ptRegCert              String?
  ptEnrCert              String?
  lwfRegNo               String?
  ddoCode                String?
  ddoRegNo               String?
  tanRegNo               String?
  paoCode                String?
  paoRegNo               String?
  ain                    String?
  tdsCircle              String?
  ministryName           String?
  ministryIfOthers       String?
  labourId               String?
  branchDivision         String
  typeOfCompany          String?
  natureOfCompany        String?
  epfCode                String?
  leaveSetupType         LeaveSetupType           @default(FINANCIAL_YEAR)
  employeeListOrder      EmployeeListOrder        @default(NAME)
  defaultAttendance      DefaultAttendance        @default(PRESENT)
  showBranchName         Boolean                  @default(false)
  dontGeneratePF         Boolean                  @default(false)
  deductorType           DeductorType?
  companyType            CompanyType?
  addressChangedEmployer Boolean                  @default(false)
  adminId                String?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime                 @updatedAt
  deletedAt              DateTime?
  archivedAt             DateTime?
  createdBy              String?
  updatedBy              String?
  searchVector           Unsupported("tsvector")?
  attendanceTypes        AttendanceTypeConfig[]
  attendanceRecords      Attendance[]
  authorizedPerson       AuthorizedPerson?
  backups                Backup[]
  branches               Branch[]
  admin                  User?                    @relation("CompanyAdmin", fields: [adminId], references: [id])
  departments            Department[]
  designations           Designation[]
  employeeCategories     EmployeeCategory[]
  employees              Employee[]
  grades                 Grade[]
  leaveApplications      LeaveApplication[]
  leaveTypes             LeaveTypeConfig[]
  levels                 Level[]
  payrollCycles          PayrollCycle[]
  payrollRecords         PayrollRecord[]
  pfEsiRates             PFESIRate[]
  salaryHeads            SalaryHead[]
  shiftRotations         ShiftRotation[]
  shifts                 Shift[]
  shortLeavePolicies     ShortLeavePolicy[]

  @@unique([code, branchDivision])
  @@index([code])
  @@index([name])
  @@index([pan])
  @@index([tan])
  @@index([gstin])
  @@index([status])
  @@index([startDate])
  @@index([endDate])
  @@index([state])
  @@index([branchDivision])
  @@index([deletedAt])
  @@index([createdAt])
  @@index([adminId])
  @@index([email])
  @@index([status, deletedAt])
  @@index([status, visibility])
  @@index([companyType, status])
  @@index([createdAt, status])
  @@index([searchVector], type: Gin)
  @@map("companies")
}

model AuthorizedPerson {
  id             String    @id @default(cuid())
  companyId      String    @unique
  name           String
  designation    String
  fatherName     String?
  dob            DateTime? @db.Date
  gender         Gender    @default(MALE)
  premise        String?
  flat           String
  road           String?
  area           String?
  city           String
  state          String?
  pin            String    @db.VarChar(6)
  pan            String    @db.VarChar(10)
  email          String?   @db.VarChar(255)
  stdCode        String?
  phone          String?
  addressChanged Boolean   @default(false)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  createdBy      String?
  updatedBy      String?
  company        Company   @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([pan])
  @@index([companyId])
  @@index([email])
  @@map("authorized_persons")
}

model Branch {
  id           String     @id @default(cuid())
  companyId    String
  name         String
  code         String     @db.VarChar(50)
  isHeadOffice Boolean    @default(false)
  flat         String?
  road         String?
  city         String?
  state        StateCode?
  pin          String?    @db.VarChar(6)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  createdBy    String?
  updatedBy    String?
  company      Company    @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, code])
  @@index([companyId])
  @@index([code])
  @@index([companyId, isHeadOffice])
  @@map("branches")
}

model Department {
  id        String   @id @default(cuid())
  companyId String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?
  updatedBy String?
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([companyId, name])
  @@map("departments")
}

model Designation {
  id        String   @id @default(cuid())
  companyId String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?
  updatedBy String?
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([companyId, name])
  @@map("designations")
}

model EmployeeCategory {
  id        String   @id @default(cuid())
  companyId String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?
  updatedBy String?
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@map("employee_categories")
}

model Level {
  id        String   @id @default(cuid())
  companyId String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?
  updatedBy String?
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@map("levels")
}

model Grade {
  id        String   @id @default(cuid())
  companyId String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?
  updatedBy String?
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@map("grades")
}

model AttendanceTypeConfig {
  id        String   @id @default(cuid())
  companyId String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?
  updatedBy String?
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@map("attendance_type_configs")
}

model SalaryHead {
  id                  String               @id @default(cuid())
  companyId           String
  name                String
  shortName           String?
  form16Field         String?
  fieldType           String
  calcBase            String?
  isPercentage        Boolean              @default(false)
  value               Float?
  applicableFor       Json?
  percentageOf        String?
  isSystem            Boolean              @default(false)
  systemCode          String?
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  createdBy           String?
  updatedBy           String?
  employeeSalaryHeads EmployeeSalaryHead[]
  company             Company              @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([companyId, name])
  @@index([fieldType])
  @@map("salary_heads")
}

model Employee {
  id                       String                @id @default(cuid())
  companyId                String
  code                     String                @db.VarChar(20)
  name                     String
  fatherHusbandName        String?
  pan                      String?               @db.VarChar(10)
  aadhaar                  String?               @db.VarChar(12)
  uan                      String?               @db.VarChar(12)
  pfAcNo                   String?               @db.VarChar(30)
  esiNo                    String?               @db.VarChar(20)
  email                    String?               @db.VarChar(255)
  nasscomRegNo             String?
  gender                   Gender                @default(MALE)
  maritalStatus            MaritalStatus         @default(UNMARRIED)
  dob                      DateTime?             @db.Date
  doj                      DateTime              @db.Date
  dor                      DateTime?             @db.Date
  dateOfMarriage           DateTime?             @db.Date
  fathersName              String?
  mothersName              String?
  caste                    String?
  bloodGroup               BloodGroup?
  nationality              String?
  religion                 Religion?
  noOfDependent            Int?
  spouse                   String?
  photo                    String?
  physicallyHandicap       String?
  registeredInPmrpy        Boolean               @default(false)
  emergencyContact         String?
  emergencyPhone           String?
  permanentAddressId       String?               @unique
  correspondenceAddressId  String?               @unique
  stdCode                  String?
  phone                    String?
  mobile                   String?
  internalId               String?
  scale                    String?
  ptGroup                  String?
  noticePeriodMonths       Int?
  probationPeriodMonths    Int?
  confirmationDate         DateTime?             @db.Date
  resigLetterDate          DateTime?             @db.Date
  resigDateLwd             DateTime?             @db.Date
  resignationReason        String?
  appraisalDate            DateTime?             @db.Date
  commitmentCompletionDate DateTime?             @db.Date
  dateOfDeath              DateTime?             @db.Date
  identityMark             String?
  reimbursementApplicable  Boolean               @default(false)
  branch                   String?
  department               String?
  designation              String?
  level                    String?
  grade                    String?
  category                 String?
  attendanceType           String?
  shiftId                  String?
  bankName                 String?
  bankBranch               String?
  bankIfsc                 String?
  bankAddress              String?
  nameAsPerAc              String?
  salaryAcNumber           String?
  paymentMode              PaymentMode?          @default(TRANSFER)
  acType                   AccountType?          @default(ECS)
  bankRefNo                String?
  wardCircleRange          String?
  licPolicyNo              String?
  policyTerm               String?
  licId                    String?
  annualRenewableDate      DateTime?             @db.Date
  hraApplicable            Boolean               @default(false)
  bonusApplicable          Boolean               @default(false)
  gratuityApplicable       Boolean               @default(false)
  lwfApplicable            Boolean               @default(false)
  pfApplicable             Boolean               @default(false)
  pfJoiningDate            DateTime?             @db.Date
  pfLastDate               DateTime?             @db.Date
  previousPfNo             String?
  salaryForPfOption        String?
  salaryForPf              Float?
  minAmtPf                 Float?
  pensionAppl              Boolean               @default(false)
  pensionJoiningDate       DateTime?             @db.Date
  pensionOnHigherWages     Boolean               @default(false)
  noLimit                  Boolean               @default(false)
  esiApplicable            Boolean               @default(false)
  esiJoiningDate           DateTime?             @db.Date
  esiLastDate              DateTime?             @db.Date
  salaryForEsiOption       String?
  salaryForEsi             Float?
  minAmtEsiContribution    Float?
  dispensaryOrPanel        String?
  recruitmentAgency        String?
  bankMandate              String?
  employmentStatus         EmployeeStatus        @default(ACTIVE)
  lapTops                  String?
  companyVehicle           String?
  corpCreditCardNo         String?
  transportRoute           String?
  workLocation             String?
  reasonForLeaving         String?
  service                  String?
  remarks                  String?
  createdAt                DateTime              @default(now())
  updatedAt                DateTime              @updatedAt
  deletedAt                DateTime?
  createdBy                String?
  updatedBy                String?
  attendanceRecords        Attendance[]
  assets                   CompanyAsset[]
  salaryConfig             EmployeeSalaryConfig?
  salaryBreakdown          EmployeeSalaryHead[]
  company                  Company               @relation(fields: [companyId], references: [id], onDelete: Cascade)
  correspondenceAddress    Address?              @relation("CorrespondenceAddress", fields: [correspondenceAddressId], references: [id])
  permanentAddress         Address?              @relation("PermanentAddress", fields: [permanentAddressId], references: [id])
  shift                    Shift?                @relation(fields: [shiftId], references: [id])
  experiences              Experience[]
  familyMembers            FamilyMember[]
  leaveApplications        LeaveApplication[]
  nominees                 Nominee[]
  payrollRecords           PayrollRecord[]
  qualifications           Qualification[]
  witnesses                Witness[]

  @@unique([companyId, code])
  @@index([companyId])
  @@index([pan])
  @@index([uan])
  @@index([esiNo])
  @@index([aadhaar])
  @@index([email])
  @@index([doj])
  @@index([dor])
  @@index([department])
  @@index([designation])
  @@index([branch])
  @@index([category])
  @@index([level])
  @@index([grade])
  @@index([attendanceType])
  @@index([employmentStatus])
  @@index([deletedAt])
  @@index([shiftId])
  @@index([companyId, deletedAt])
  @@index([companyId, employmentStatus])
  @@index([companyId, department])
  @@index([companyId, designation])
  @@index([companyId, branch])
  @@index([companyId, category])
  @@index([department, employmentStatus])
  @@index([doj, employmentStatus])
  @@index([companyId, doj])
  @@index([companyId, shiftId])
  @@map("employees")
}

model EmployeeSalaryConfig {
  id                   String   @id @default(cuid())
  companyId            String
  employeeId           String   @unique
  salaryMode           String
  inputAmount          Float
  grossSalary          Float
  netSalary            Float
  annualCtc            Float
  pfRuleSnapshot       Json
  esiRuleSnapshot      Json
  gratuityRuleSnapshot Json
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  employee             Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@map("employee_salary_configs")
}

model Address {
  id                       String     @id @default(cuid())
  permanentEmployeeId      String?    @unique
  correspondenceEmployeeId String?    @unique
  flat                     String?
  building                 String?
  area                     String?
  road                     String?
  city                     String?
  district                 String?
  state                    StateCode?
  pin                      String?    @db.VarChar(6)
  createdAt                DateTime   @default(now())
  updatedAt                DateTime   @updatedAt
  correspondenceEmployee   Employee?  @relation("CorrespondenceAddress")
  permanentEmployee        Employee?  @relation("PermanentAddress")

  @@index([state])
  @@index([city])
  @@index([pin])
  @@map("addresses")
}

model Qualification {
  id           String   @id @default(cuid())
  employeeId   String
  college      String?
  degree       String?
  subject      String?
  fromYear     Int?
  toYear       Int?
  year         String?
  cgpa         String?
  percentage   String?
  regNo        String?
  validityYear Int?
  certificate  String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  employee     Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@index([employeeId, fromYear])
  @@map("qualifications")
}

model Experience {
  id          String   @id @default(cuid())
  employeeId  String
  companyName String
  location    String?
  designation String
  from        DateTime @db.Date
  to          DateTime @db.Date
  remark      String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  employee    Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@index([employeeId, from])
  @@map("experiences")
}

model FamilyMember {
  id           String   @id @default(cuid())
  employeeId   String
  name         String
  relationship String
  dobAge       String?
  residingWith Boolean  @default(true)
  address      String?
  district     String?
  state        String?
  aadhar       String?
  remark       String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  employee     Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@index([employeeId, relationship])
  @@map("family_members")
}

model Nominee {
  id            String         @id @default(cuid())
  employeeId    String
  name          String
  relationship  String
  dobAge        String?
  address       String?
  district      String?
  state         String?
  pin           String?
  gratuityShare Float?
  maritalStatus MaritalStatus?
  remark        String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  employee      Employee       @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@map("nominees")
}

model Witness {
  id         String   @id @default(cuid())
  employeeId String
  name       String
  address    String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  employee   Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@map("witnesses")
}

model CompanyAsset {
  id         String   @id @default(cuid())
  employeeId String
  particular String
  remark     String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  createdBy  String?
  updatedBy  String?
  employee   Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@map("company_assets")
}

model EmployeeSalaryHead {
  id               String     @id @default(cuid())
  companyId        String
  employeeId       String
  salaryHeadId     String
  headName         String
  headType         String
  baseAmount       Float
  netAmount        Float
  pfEmployee       Float      @default(0)
  pfEmployer       Float      @default(0)
  esiEmployee      Float      @default(0)
  esiEmployer      Float      @default(0)
  gratuityEmployer Float      @default(0)
  createdAt        DateTime   @default(now())
  employee         Employee   @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  salaryHead       SalaryHead @relation(fields: [salaryHeadId], references: [id])

  @@index([salaryHeadId])
  @@index([employeeId])
  @@index([companyId])
  @@map("employee_salary_heads")
}

model Attendance {
  id            String           @id @default(cuid())
  companyId     String
  employeeId    String
  date          DateTime         @db.Date
  checkIn       DateTime?
  checkOut      DateTime?
  breakStart    DateTime?
  breakEnd      DateTime?
  status        AttendanceStatus @default(PRESENT)
  workingHours  Float?           @default(0)
  overtimeHours Float?           @default(0)
  notes         String?
  location      String?
  shiftId       String?
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  createdBy     String?
  updatedBy     String?
  company       Company          @relation(fields: [companyId], references: [id], onDelete: Cascade)
  employee      Employee         @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  shift         Shift?           @relation(fields: [shiftId], references: [id])

  @@unique([employeeId, date])
  @@index([companyId])
  @@index([employeeId])
  @@index([date])
  @@index([status])
  @@index([companyId, date])
  @@index([employeeId, date])
  @@index([companyId, employeeId, date])
  @@index([companyId, status, date])
  @@index([shiftId])
  @@map("attendances")
}

model LeaveTypeConfig {
  id                String             @id @default(cuid())
  companyId         String
  name              String
  code              String?
  type              LeaveType          @default(FULL_DAY)
  payConsume        Boolean            @default(true)
  allowApply        Boolean            @default(true)
  halfDay           Boolean            @default(false)
  accrueRule        String?
  fixedDays         Int?
  fixedPeriod       String?
  plPer             Float?
  plBasis           String?
  minAttendance     Int?
  maxPerMonth       Int?
  availedFrom       String?
  autoAllot         Boolean            @default(false)
  restrictDays      Int?
  mandatoryDocDays  Int?
  allowEncash       Boolean            @default(false)
  minEncash         Int?
  maxEncash         Int?
  cfOption          String?
  cfMaxLimit        Int?
  totalPerYear      Int?
  isActive          Boolean            @default(true)
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  createdBy         String?
  updatedBy         String?
  leaveApplications LeaveApplication[]
  company           Company            @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([companyId, isActive])
  @@map("leave_type_configs")
}

model LeaveApplication {
  id              String          @id @default(cuid())
  companyId       String
  employeeId      String
  leaveTypeId     String
  startDate       DateTime        @db.Date
  endDate         DateTime        @db.Date
  days            Float
  type            LeaveType       @default(FULL_DAY)
  status          LeaveStatus     @default(PENDING)
  reason          String?
  appliedDate     DateTime        @default(now())
  approvedBy      String?
  approvedAt      DateTime?
  rejectedBy      String?
  rejectedAt      DateTime?
  rejectionReason String?
  documents       Json?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  createdBy       String?
  updatedBy       String?
  company         Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  employee        Employee        @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  leaveType       LeaveTypeConfig @relation(fields: [leaveTypeId], references: [id])

  @@index([companyId])
  @@index([employeeId])
  @@index([leaveTypeId])
  @@index([status])
  @@index([startDate])
  @@index([endDate])
  @@index([companyId, employeeId])
  @@index([companyId, status])
  @@index([employeeId, status])
  @@index([employeeId, startDate, endDate])
  @@index([companyId, startDate, endDate])
  @@map("leave_applications")
}

model Shift {
  id                      String          @id @default(cuid())
  companyId               String
  name                    String
  code                    String?
  startTime               String
  endTime                 String
  breakDuration           Int?
  workingHours            Float?
  shiftType               ShiftType       @default(FIXED)
  checkInAllowedFrom      Int?
  checkOutAllowedFrom     Int?
  shiftAllowance          Boolean         @default(false)
  weeklyOffPattern        String[]
  restrictManagerBackdate Boolean         @default(false)
  restrictHRBackdate      Boolean         @default(false)
  restrictManagerFuture   Boolean         @default(false)
  isActive                Boolean         @default(true)
  createdAt               DateTime        @default(now())
  updatedAt               DateTime        @updatedAt
  createdBy               String?
  updatedBy               String?
  attendanceRecords       Attendance[]
  employees               Employee[]
  shiftRotations          ShiftRotation[]
  company                 Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([companyId, isActive])
  @@map("shifts")
}

model ShiftRotation {
  id              String    @id @default(cuid())
  companyId       String
  shiftId         String
  employeeId      String?
  department      String?
  startDate       DateTime  @db.Date
  endDate         DateTime? @db.Date
  rotationPattern Json?
  isActive        Boolean   @default(true)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  createdBy       String?
  updatedBy       String?
  company         Company   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  shift           Shift     @relation(fields: [shiftId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([shiftId])
  @@index([employeeId])
  @@index([companyId, startDate, endDate])
  @@map("shift_rotations")
}

model PayrollCycle {
  id             String          @id @default(cuid())
  companyId      String
  cycleType      String
  startDate      DateTime        @db.Date
  endDate        DateTime        @db.Date
  isActive       Boolean         @default(true)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  createdBy      String?
  updatedBy      String?
  company        Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  payrollRecords PayrollRecord[]

  @@index([companyId])
  @@index([cycleType])
  @@index([startDate, endDate])
  @@index([companyId, cycleType])
  @@index([companyId, isActive])
  @@map("payroll_cycles")
}

model PayrollRecord {
  id                  String        @id @default(cuid())
  companyId           String
  employeeId          String
  payrollCycleId      String?
  month               Int
  year                Int
  basicSalary         Float
  hra                 Float         @default(0)
  conveyanceAllowance Float         @default(0)
  medicalAllowance    Float         @default(0)
  specialAllowance    Float         @default(0)
  grossSalary         Float
  providentFund       Float         @default(0)
  esi                 Float         @default(0)
  professionalTax     Float         @default(0)
  incomeTax           Float         @default(0)
  otherDeductions     Float         @default(0)
  totalDeductions     Float
  netSalary           Float
  workingDays         Int
  presentDays         Int
  leaveDays           Int           @default(0)
  overtimeHours       Float         @default(0)
  overtimeAmount      Float         @default(0)
  lateDeduction       Float         @default(0)
  status              PayrollStatus @default(DRAFT)
  processedAt         DateTime?
  paidAt              DateTime?
  remarks             String?
  metadata            Json?
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
  createdBy           String?
  updatedBy           String?
  company             Company       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  employee            Employee      @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  payrollCycle        PayrollCycle? @relation(fields: [payrollCycleId], references: [id])

  @@unique([employeeId, month, year])
  @@index([companyId])
  @@index([employeeId])
  @@index([payrollCycleId])
  @@index([month, year])
  @@index([status])
  @@index([companyId, month, year])
  @@index([employeeId, month, year])
  @@index([companyId, status])
  @@map("payroll_records")
}

model PFESIRate {
  id                 String        @id @default(cuid())
  companyId          String
  rateType           StatutoryType
  gratuityPercent    Float?
  gratuityBase       String?
  empShare           Float?
  employerShare      Float?
  esiWageCeiling     Float?
  empShareAc1        Float?
  erShareAc2         Float?
  adminChargesAc10   Float?
  epsAc21            Float?
  edliChargesAc21    Float?
  adminChargesAc22   Float?
  calcType           String?
  pfWageCeiling      Float?
  epsWageCeiling     Float?
  minEpsContribution Float?
  effectiveFrom      DateTime      @db.Date
  effectiveTo        DateTime?     @db.Date
  remarks            String?
  isActive           Boolean       @default(true)
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
  createdBy          String?
  updatedBy          String?
  company            Company       @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([rateType])
  @@index([effectiveFrom, effectiveTo])
  @@index([companyId, rateType])
  @@index([companyId, isActive])
  @@index([companyId, effectiveFrom])
  @@map("pf_esi_rates")
}

model ShortLeavePolicy {
  id                   String   @id @default(cuid())
  companyId            String
  name                 String
  applicableOn         String?
  totalHours           Int      @default(2)
  totalMinutes         Int      @default(0)
  minHours             Int      @default(1)
  minMinutes           Int      @default(0)
  maxHours             Int      @default(1)
  maxMinutes           Int      @default(0)
  deductBalance        Boolean  @default(true)
  allowBackdated       Boolean  @default(true)
  advanceApplicability String?
  status               String   @default("Active")
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  company              Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([companyId, status])
  @@map("short_leave_policies")
}

model User {
  id          String    @id @default(cuid())
  name        String?
  email       String    @unique
  role        String    @default("USER")
  password    String?
  isActive    Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  lastLoginAt DateTime?
  companies   Company[] @relation("CompanyAdmin")

  @@index([email])
  @@index([role])
  @@index([isActive])
  @@index([email, isActive])
  @@map("users")
}

model Backup {
  id          String   @id @default(cuid())
  companyId   String
  version     String
  filePath    String?
  fileUrl     String?
  sizeInBytes BigInt?
  metadata    Json?
  createdAt   DateTime @default(now())
  createdBy   String?
  company     Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdAt])
  @@index([companyId, createdAt])
  @@map("backups")
}

enum StatutoryType {
  PF
  ESI
  GRATUITY
}

enum StateCode {
  ANDHRA_PRADESH
  ARUNACHAL_PRADESH
  ASSAM
  BIHAR
  CHHATTISGARH
  GOA
  GUJARAT
  HARYANA
  HIMACHAL_PRADESH
  JHARKHAND
  KARNATAKA
  KERALA
  MADHYA_PRADESH
  MAHARASHTRA
  MANIPUR
  MEGHALAYA
  MIZORAM
  NAGALAND
  ODISHA
  PUNJAB
  RAJASTHAN
  SIKKIM
  TAMIL_NADU
  TELANGANA
  TRIPURA
  UTTAR_PRADESH
  UTTARAKHAND
  WEST_BENGAL
  DELHI

  @@map("state_code")
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

enum MaritalStatus {
  MARRIED
  UNMARRIED
  DIVORCED
  WIDOWED
}

enum BloodGroup {
  A_POSITIVE  @map("A+")
  A_NEGATIVE  @map("A-")
  B_POSITIVE  @map("B+")
  B_NEGATIVE  @map("B-")
  AB_POSITIVE @map("AB+")
  AB_NEGATIVE @map("AB-")
  O_POSITIVE  @map("O+")
  O_NEGATIVE  @map("O-")
}

enum Religion {
  HINDU
  MUSLIM
  CHRISTIAN
  SIKH
  BUDDHIST
  JAIN
  OTHERS
}

enum PaymentMode {
  TRANSFER
  CHEQUE
  CASH
}

enum AccountType {
  ECS
  NEFT
  RTGS
  IMPS
}

enum EmployeeStatus {
  ACTIVE
  PROBATION
  RESIGNED
  TERMINATED
  RETIRED
  DECEASED

  @@map("employee_status")
}

enum CompanyStatus {
  ACTIVE
  INACTIVE
  ARCHIVED
  SUSPENDED

  @@map("company_status")
}

enum CompanyVisibility {
  PUBLIC
  PRIVATE
  HIDDEN

  @@map("company_visibility")
}

enum DefaultAttendance {
  PRESENT
  ABSENT
  HALF_DAY

  @@map("default_attendance")
}

enum LeaveSetupType {
  FINANCIAL_YEAR
  CALENDAR_YEAR

  @@map("leave_setup_type")
}

enum EmployeeListOrder {
  NAME
  ID
  DEPARTMENT

  @@map("employee_list_order")
}

enum DeductorType {
  GOV
  UNION_GOV
  OTHERS
}

enum CompanyType {
  GOVERNMENT
  OTHERS
}

enum AttendanceStatus {
  PRESENT
  ABSENT
  LATE
  HALF_DAY
  ON_LEAVE
  HOLIDAY
  WEEKEND

  @@map("attendance_status")
}

enum LeaveStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED

  @@map("leave_status")
}

enum LeaveType {
  FULL_DAY
  HALF_DAY

  @@map("leave_type")
}

enum PayrollStatus {
  DRAFT
  PROCESSING
  COMPLETED
  PAID
  CANCELLED

  @@map("payroll_status")
}

enum ShiftType {
  FIXED
  ROTATING
  FLEXIBLE

  @@map("shift_type")
}
